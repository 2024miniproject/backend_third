<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸€ì‘ì„±</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='write.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='bar.css') }}">
</head>

<body>
<!-- ì‚¬ì´ë“œë°” -->
<div class="sidebar">
    <div class="logo">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo">
        <button class="plus-button" id="add-button">+</button> <!-- ID ì¶”ê°€ -->
    </div>

    <ul class="menu">
        <li><a href="#"><span class="icon" onclick="location.href='/home'">ğŸ </span> Home</a></li>
        <li><a href="#"><span class="icon" onclick="location.href='/mydeal_views/mydealbuy'">ğŸ“¦</span> My deal</a></li>
        <li><a href="#"><span class="icon" onclick="location.href='/information'">â„¹ï¸</span> Info</a></li>
    </ul>
</div>

<!-- Form ì˜ì—­ -->
<form action="{{ url_for('write_views.write') }}" method="post" enctype="multipart/form-data">
    <div class="title">ì œëª©</div>
    <input class="titlearea" type="text" id="title" name="title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”!" required><br>

    <hr class="line1">
    <div class="price">ê°€ê²©</div>
    <input class="pricearea" type="text" id="price" name="price" placeholder="ì´ë²ˆ ì œí’ˆì€ ì–¼ë§ˆì¸ê°€ìš”?" required><br>

    <hr class="line2">

    <!-- ë‚´ìš© ì…ë ¥ ì˜ì—­ -->
    <div class="textarea-wrapper">
        <textarea class="textarea" id="content" name="content" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”." rows="1"
                  oninput="this.style.height = ''; this.style.height = this.scrollHeight + 'px';"
                  required></textarea><br>
    </div>

    <!-- ì‚¬ì§„ ì—…ë¡œë“œ ë¶€ë¶„ì„ ë‚´ìš© ì…ë ¥ ì˜ì—­ ì•„ë˜ë¡œ ì´ë™ -->
    <label class="upload-box" for="file-upload">
        <span class="upload-icon">+</span> ì‚¬ì§„ ì—…ë¡œë“œ
    </label>
    <input id="file-upload" type="file" name="files" multiple accept="image/*" style="display: none;"
           onchange="previewImage(event)">

    <div id="image-container"></div> <!-- ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ -->

    <button class="publish-button" type="submit">ë°œí–‰í•˜ê¸°</button>
</form>

<!-- ë¯¸ë¦¬ë³´ê¸° ìŠ¤í¬ë¦½íŠ¸ -->
<script>
    // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° í•¨ìˆ˜
    function previewImage(event) {
        var output = document.getElementById('image-container');
        output.innerHTML = ''; // ì´ì „ ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ ì´ˆê¸°í™”
        for (var i = 0; i < event.target.files.length; i++) {
            var reader = new FileReader();
            reader.onload = function(e) {
                output.innerHTML += '<img src="'+e.target.result+'" style="max-width: 100%; height: auto; margin: 5px;"/>';  // ëª¨ë“  ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ ì¶”ê°€
            };
            reader.readAsDataURL(event.target.files[i]);  // ëª¨ë“  íŒŒì¼ì„ ì½ì–´ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
        }
    }

    // + ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
    let clickCount = 0;

    document.querySelector('#add-button').addEventListener('click', function(event) {
        clickCount++;
        if (clickCount === 1) {
            // ì²« ë²ˆì§¸ í´ë¦­ ì‹œ ê¸€ ì‘ì„± í˜ì´ì§€ë¡œ ì´ë™
            window.location.href = "{{ url_for('write_views.write') }}";
        } else {
            // ë‘ ë²ˆì§¸ í´ë¦­ ì´í›„ì—ëŠ” íŒì—…ì°½ í‘œì‹œ
            event.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€
            if (confirm("ì‘ì„±ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                // í™•ì¸ ë²„íŠ¼ì„ ëˆ„ë¥¸ ê²½ìš°
                window.location.href = "{{ url_for('write_views.write') }}"; // ê¸€ ì‘ì„± í˜ì´ì§€ë¡œ ì´ë™
            }
            // ì·¨ì†Œ ë²„íŠ¼ì„ ëˆ„ë¥¸ ê²½ìš° ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ
        }
    });
</script>
</body>
</html>
